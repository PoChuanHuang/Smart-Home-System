---
title: 'Smart Home System'
disqus: hackmd
---

Title
===
**智慧居家系統-社區智慧垃圾清運服務
成員:黃柏銓、黃鈺雲、王毓惠、蔡旻諺**


## 簡介

社區垃圾桶及周遭環境維護不易。例如：垃圾未能即時清運可能會滿出來、垃圾桶蓋無法關閉、特殊垃圾發臭等問題，均會影響居家生活品質。本專題就針對社區垃圾桶使用的需求，利用物聯網技術提供解決方案。


## 系統架構

## 功能說明
#### 1.智能垃圾桶
以聯發科LinkIt One的微控制器加上各式感測器模擬社區垃圾桶的情境，包含圖1的(A)氣體感測器MQ135、(B)紅外線感測器，用以蒐集垃圾的高度與臭味等資訊、(C)三軸感測器，用以判斷垃圾蓋是否關好，若沒關好則會自動撥打給管理員手機做通知、(D)超音波感測器，實現非接觸式的垃圾桶蓋開關。藉此提供即時垃圾資訊收集與紀錄，有效掌控垃圾量。 

微處理器會根據感測器的數據不同進行動作，例如 : 超音波偵測到手靠近會命令馬達執行打開的動作；當手離開時，則命令馬達執行關閉的動作。

```gherkin=
手靠近
```
距離感測的程式碼分別為超音波手部偵測和紅外線垃圾高度偵測。
``` gherkin=
距離感測的程式碼
```

馬達根據旋轉到不同角度來完成開啟及關閉動作。
``` gherkin=
馬達程式碼
```

#### 2.智慧使用者服務
UI介面設定及實體化
``` gherkin=
UI介面設定及實體化
```
資料抓取以及解析json格式程式碼
``` gherkin=
資料抓取以及解析json格式程式碼
```
以Message傳送給Handler並更新UI畫面
```gherkin=
以Message傳送給Handler並更新UI畫面
```
連線Server抓取相關資料
```gherkin=
連線Server抓取相關資料
```
在app端建立網路連線需用thread執行緒執行，因此先創一Handler來接收其他的Thread來的訊息，接著建立HTTP POST連線送出資料
```gherkin=

```
在Service 的類別中，生命週期的OnStartCommand()使用Android的Calendar類別設定時間，當到達指定時間的時候，系統會進行廣播。
```gherkin=

```
在BroadcastReceiver的onReceive()使用Android系統通知API的「android.app」套件下的「Notification」與「NotificationManager」類別去發送通知訊息與震動提醒使用者。
```gherkin=

```
#### 3.清運公司路線規劃系統
先使用LocationManager先取得貨車司機的當前位置
```gherkin=

```
再把所有清運點依照清運司機當前位置由近而遠做排列，最後將清運點加入GOOGLE導航
```gherkin=

```

## 結論
智能垃圾桶能夠自動地開關與蒐集垃圾的高度與臭味等資訊，有效掌控垃圾量的增減變化。智慧使用者服務的預約清運服務讓清運公司即時了解客戶的需求並即刻給予回覆，讓服務由被動轉為主動。清運公司路線規劃系統有效安排清運站點路線，節省了司機的人力與時間成本，提升清運公司的效益。未來希望藉由統計圖表分析該社區倒垃圾的模式，有效預測客戶需求，確保一定程度的準確度。